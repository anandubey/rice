#==============================================================================
#
#                           Sway Config                                       
#                       author:- anandubey                                   
#
#==============================================================================



#==================== Autostart Applications

# Polkit agent:
exec /usr/lib/xfce-polkit/xfce-polkit

# Notification Daemon
exec mako

# GTK3 applications take a long time to start
exec systemctl --user import-environment DISPLAY WAYLAND_DISPLAY SWAYSOCK
exec hash dbus-update-activation-environment 2>/dev/null && \
     dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY SWAYSOCK 
 
# # Wob
# exec mkfifo $SWAYSOCK.wob
# exec tail -f $SWAYSOCK.wob | wob -b 3 -p 2 --border-color '#75a7d0FF' --background-color '#2b2e2fFF' --bar-color '#96CDFBFF'

# Autotiling
# exec autotiling

# Night Light
exec ~/.config/sway/scripts/light.sh

# Clipman
exec clipman restore
exec wl-paste -t text --watch clipman store

# Gnome Keyring
exec gnome-keyring-daemon --daemonize --start --components=gpg,pkcs11,secrets,ssh

# # for Touchpad gestures
# exec libinput-gestures-setup start

# # Outputs
# exec kanshi




#==================== Application Defaults 

# Assign workspaces
assign [app_id="firefox"] 2
for_window [app_id="firefox"] focus

assign [class="firefox"] 2
for_window [class="firefox"] focus

assign [app_id="brave"] 2
for_window [app_id="brave"] focus

assign [class="brave"] 2
for_window [class="brave"] focus

assign [app_id=thunar] 4
for_window [app_id=thunar] focus


# set floating (nontiling)for apps needing it:
for_window [class="Yad" instance="yad"] floating enable
for_window [app_id="yad"] floating enable
for_window [app_id="blueman-manager"] floating enable,  resize set width 40 ppt height 30 ppt

# set floating (nontiling) for special apps:
for_window [class="Xsane" instance="xsane"] floating enable
for_window [app_id="pavucontrol" ] floating enable, resize set width 40 ppt height 30 ppt
for_window [class="qt5ct" instance="qt5ct"] floating enable, resize set width 60 ppt height 50 ppt
for_window [class="Bluetooth-sendto" instance="bluetooth-sendto"] floating enable
for_window [app_id="pamac-manager"] floating enable, resize set width 80 ppt height 70 ppt
for_window [class="Lxappearance"] floating enable, resize set width 60 ppt height 50 ppt

# set floating for window roles
for_window [window_role="pop-up"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_role="Preferences"] floating enable
for_window [window_type="dialog"] floating enable
for_window [window_type="menu"] floating enable
for_window [window_role="About"] floating enable
for_window [title="File Operation Progress"] floating enable, border pixel 1, sticky enable, resize set width 40 ppt height 30 ppt
for_window [app_id="firefox" title="Library"] floating enable, border pixel 1, sticky enable, resize set width 40 ppt height 30 ppt
for_window [app_id="floating_shell_portrait"] floating enable, border pixel 1, sticky enable, resize set width 30 ppt height 40 ppt
for_window [title="Picture in picture"] floating enable, sticky enable
for_window [title="nmtui"] floating enable,  resize set width 50 ppt height 70 ppt
for_window [title="htop"] floating enable, resize set width 50 ppt height 70 ppt
for_window [app_id="xsensors"] floating enable
for_window [title="Save File"] floating enable
for_window [app_id="firefox" title="Firefox â€” Sharing Indicator"] kill


# Auto float apps
# for_window [app_id="system-config-printer"] floating enable
# for_window [app_id="gnome-calculator"] floating enable
# for_window [app_id="keepassxc"] floating enable
# for_window [app_id="(?i)mpv"] floating enable
# for_window [app_id="pavucontrol"] floating enable
# for_window [app_id="(?i)thunar"] floating enable
# for_window [app_id="vlc"] floating enable
# for_window [app_id="tlp-ui"] floating enable
# for_window [app_id="pamac-manager"] floating enable
# for_window [app_id="nm-connection-editor$"] floating enable
# for_window [app_id="simple-scan"] floating enable
# for_window [app_id="firetools"] floating enable
# for_window [app_id="firewall-config"] floating enable
# for_window [app_id="gnome-(calendar|calculator|power-statistics|control-center)"] floating enable
# for_window [app_id="org.gnome.(Nautilus|Weather)"] floating enable
# for_window [app_id="(pavucontrol|psensor)"] floating enable
# for_window [app_id="soffice"] floating enable
# for_window [title="^Open File$"] floating enable
# for_window [title="Weather report: 44240 - qutebrowser"] floating enable
# for_window [title="nmtui - Kitty"] floating enable
# for_window [title="Update Check|Cryptomator"] floating enable, resize set 800 600
# for_window [window_role="GtkFileChooserDialog"] resize set 800 600
# for_window [window_role="GtkFiileChooserDialog"] move position center




# Default Floating
for_window [app_id="(pavucontrol|psensor)"] floating enable








#==================== Clamshell Config

# Clamshell Mode
set $laptop eDP-1

bindswitch --reload --locked lid:on output $laptop disable
bindswitch --reload --locked lid:off output $laptop enable
exec_always ~/.config/sway/scripts/clamshell.sh



#==================== Default Config

set $mod Mod4
set $alt Mod1

# Set Directions
set $left h
set $down j
set $up k
set $right l

# Default apps
set $term kitty
set $menu wofi --show drun 
set $browser brave

# Launch  terminal
bindsym $mod+Return exec $term

# Kill focused window
bindsym $mod+q kill

# Run app launcher
bindsym $mod+p exec $menu

# Launch browser
bindsym $mod+b exec $browser

# Screen lock
bindsym $mod+BackSpace exec swaylock

# Toggle between last and current workspace
bindsym $mod+Tab workspace back_and_forth

# Drag windows with mouse
floating_modifier $mod normal

# Reload the configuration file
bindsym $mod+Shift+c reload
bindsym $mod+Shift+r reload

# Move your focus around
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right

# Move the focused window
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right


# Switch to workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1, workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2, workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3, workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4, workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5, workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6, workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7, workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8, workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9, workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10, workspace number 10

# Layout Control
bindsym $mod+m splith
bindsym $mod+n splitv

# Switch the current container between different layout styles
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+x layout toggle split

# Make the current focus fullscreen
bindsym $mod+f fullscreen

# Toggle the current focus between tiling and floating mode
bindsym $mod+space floating toggle

# Swap focus between the tiling area and the floating area
bindsym $mod+Shift+space focus mode_toggle

# Make the currently focused window a scratchpad
bindsym $mod+Shift+Grave move scratchpad
bindsym $mod+Shift+g move scratchpad

# Show the first scratchpad window
bindsym $mod+Grave scratchpad show
bindsym $mod+g scratchpad show

# Resizing containers:
bindsym $alt+$left resize shrink width 50px
bindsym $alt+$down resize grow height 50px
bindsym $alt+$up resize shrink height 50px
bindsym $alt+$right resize grow width 50px

bindsym $alt+Left resize shrink width 50px
bindsym $alt+Down resize grow height 50px
bindsym $alt+Up resize shrink height 50px
bindsym $alt+Right resize grow width 50px

# Resize floating windows with mouse scroll:
bindsym --whole-window --border $mod+button4 resize shrink height 5 px or 5 ppt
bindsym --whole-window --border $mod+button5 resize grow height 5 px or 5 ppt
bindsym --whole-window --border $mod+shift+button4 resize shrink width 5 px or 5 ppt
bindsym --whole-window --border $mod+shift+button5 resize grow width 5 px or 5 ppt

# Media Controls
bindsym XF86AudioRaiseVolume exec pamixer -ui 2
bindsym XF86AudioLowerVolume exec pamixer -ud 2 
bindsym XF86AudioMute exec pamixer --toggle-mute && 

# Player
bindsym XF86AudioPlay exec playerctl play
bindsym XF86AudioPause exec playerctl pause
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPrev exec playerctl previous

# Backlight
bindsym XF86MonBrightnessDown exec brightnessctl set 5%- 
bindsym XF86MonBrightnessUp exec brightnessctl set +5% 

# # Screenshots
bindsym print exec /usr/share/sway/scripts/grimshot --notify save output



#==================== Input Config
seat seat0 xcursor_theme Qogir-dark 16

input type:touchpad {
      dwt enabled
      tap enabled
      natural_scroll enabled
}

input type:keyboard  {
    xkb_layout "us"
    xkb_options ctrl:nocaps
}

exec_always {
   'swaymsg input type:keyboard xkb_layout "$(localectl status | grep "X11 Layout" | sed -e "s/^.*X11 Layout://")"'
   'swaymsg input type:keyboard xkb_variant "$(localectl status | grep "X11 Variant" | sed -e "s/^.*X11 Variant://")"'
}



#==================== Output Config

# Laptop display
output eDP-1 mode 1920x1080 pos 1920 0 bg ~/.local/share/bg/astro.jpg fill

# External display
output HDMI-A-1 mode 1920x1080 pos 0 0 bg ~/.local/share/bg/astro.jpg fill

output DP-1 mode 1920x1080 pos 0 0 bg ~/.local/share/bg/astro.jpg fill



#==================== Idle/Lock Configuration

# Lock after 5 min, displays off after 10 min, lock after suspend
exec swayidle -w\
    timeout 300 'swaylock -f -C ~/.config/swaylock/config'\
    timeout 770 'swaymsg "output * dpms off"' \
    resume 'swaymsg "output * dpms on"' \
    before-sleep 'swaylock -C ~/.config/swaylock/config'


# Inhibit Idle if a window is fullscreen
for_window [class="^.*"] inhibit_idle fullscreen
for_window [app_id="^.*"] inhibit_idle fullscreen


#==================== Theming

# Apply gtk theming
exec_always ~/.config/sway/scripts/import-gsettings

# Set inner-outer gaps
gaps inner 4
gaps outer 4

# Hide titlebar on windows: 
default_border pixel 1

# Default Font
font pango:Noto Sans Regular 10

# Thin borders:
smart_borders on

# Title format for windows
for_window [shell="xdg_shell"] title_format "%title (%app_id)"
for_window [shell="x_wayland"] title_format "%class - %title"

# Window decoration
# class                 border  backgr. text    indicator child_border
client.focused          #7f849c #282828 #cdd6f4 #7f849c   #7f849c 
client.focused_inactive #6f8faf #282828 #cdd6f4 #414339   #414339
client.unfocused        #414339 #282828 #cdd6f4 #414339   #414339
client.urgent           #f9e2af #282828 #cdd6f4 #f9e2af   #f9e2af

# Status Bar:
bar {
   swaybar_command waybar
}
